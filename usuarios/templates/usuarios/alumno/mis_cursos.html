{% extends "usuarios/alumno/base_alumno.html" %}

{% block content %}
    <h4 class="mb-4 fw-bold">ðŸ“š Mis Cursos Matriculados</h4>

    <div class="card p-3 mb-4 shadow-sm">
        <p class="mb-0"><strong>Alumno:</strong> {{ perfil.nombre }}</p>
    </div>
    
    {% if cursos_info %}
        <div class="table-responsive">
    Â  Â      <table class="table table-striped table-hover align-middle">
                <thead class="table-dark">
            Â  Â      <tr>
                        <th scope="col">CÃ³digo</th>
                        <th scope="col">Asignatura</th>
                        <th scope="col">Grupo (TeorÃ­a)</th>
                        <th scope="col">Docente (TeorÃ­a)</th>
                        <th scope="col">Grupo (Lab)</th>
                        <th scope="col">Docente (Lab)</th>
                        <th scope="col" class="text-center">Acciones</th>
            Â  Â      </tr>
                </thead>
                <tbody>
Â  Â                  {% for curso in cursos_info %}
                        <!-- Fila principal del Curso -->
                        <tr>
                        Â  Â  <td><strong>{{ curso.curso_id }}</strong></td>
                        Â  Â  <td>{{ curso.nombre_curso }}</td>
                        Â  Â  <td><span class="badge bg-primary">{{ curso.grupo_teoria }}</span></td>
                        Â  Â  <td>{{ curso.profesor_teoria }}</td>
                        Â  Â  <td>
                                {% if curso.grupo_lab == 'N/A' %}
                                Â  Â  <span class="badge bg-danger">N/A</span>
                                {% else %}
                                Â  Â  <span class="badge bg-success">{{ curso.grupo_lab }}</span>
                                {% endif %}
                        Â  Â  </td>
                        Â  Â  <td>
                                {{ curso.profesor_lab }}
                        Â  Â  </td>
                        Â  Â  <td class="text-center">
                                <a href="{% url 'usuarios:mis_notas_alumno' %}?curso={{ curso.curso_id }}" class="btn btn-sm btn-info text-white me-3">Ver Notas</a>
                                {% if curso.grupo_lab == 'N/A' %}
                                    <a href="{% url 'usuarios:matricula_lab_alumno' %}" class="btn btn-sm btn-warning me-2">Asignar Lab</a>
                                {% endif %}
                                {% if curso.temas %}
                                    <button class="btn btn-sm btn-dark me-0" type="button" data-bs-toggle="collapse" data-bs-target="#{{ curso.collapse_id }}" aria-expanded="false" aria-controls="{{ curso.collapse_id }}">Ver Temas</button>
                                {% else %}
                                    <button class="btn btn-sm btn-secondary me-0" disabled>Sin Temas</button>
                                {% endif %}
                        Â  Â  </td>
                        </tr>

                        <!-- Fila de detalles colapsable (TEMAS) -->
                        <tr class="collapse" id="{{ curso.collapse_id }}">
                        Â  Â  <td colspan="7" class="p-0">
                                <div class="p-4 bg-light">
                                Â  Â  <h6><i class="bi bi-list-task me-2"></i> Temario de {{ curso.nombre_curso }} (Grupo: {{ curso.grupo_teoria }})</h6>
                                Â  Â  <ul class="list-group list-group-flush mt-3">
                                        {% for tema in curso.temas %}
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                        Â  Â  <!-- NÃºmero y Nombre del Tema -->
                                        Â  Â  <span>
                                                <span class="badge bg-secondary me-2">{{ tema.orden }}</span>
                                                {{ tema.nombre }}
                                        Â  Â  </span>
                                        Â  Â  
                                        Â  Â  <!-- Estado de Completado -->
                                        Â  Â  {% if tema.completado %}
                                                <span class="badge bg-success"><i class="bi bi-check-circle-fill"></i> Completado</span>
                                        Â  Â  {% else %}
                                                <span class="badge bg-warning text-dark"><i class="bi bi-clock-fill"></i> Pendiente</span>
                                        Â  Â  {% endif %}
                                        </li>
                                        {% empty %}
                                        <li class="list-group-item text-center text-muted">AÃºn no se han registrado temas para este grupo.</li>
                                        {% endfor %}
                                Â  Â  </ul>
                                </div>
                        Â  Â  </td>
                        </tr>
                    {% endfor %}
                </tbody>
Â  Â          </table>
        </div>
Â  Â  {% else %}
        <div class="alert alert-warning text-center mt-5">
        Â  Â  <strong>Â¡Aviso!</strong> No se encontraron cursos activos matriculados para el ciclo actual.
        </div>
Â  Â  {% endif %}
{% endblock content %}